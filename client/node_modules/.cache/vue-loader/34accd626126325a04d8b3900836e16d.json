{"remainingRequest":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/Jobs/DOAN-TT/client/src/views/document/Review.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/var/www/html/Jobs/DOAN-TT/client/src/views/document/Review.vue","mtime":1573548269939},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/css-loader/index.js","mtime":1571304325802},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1571304326381},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/sass-loader/dist/cjs.js","mtime":1571304338110},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js","mtime":1571304326381}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import \"./Review.scss\";\n",{"version":3,"sources":["Review.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqUA","file":"Review.vue","sourceRoot":"src/views/document","sourcesContent":["<template>\n  <div class=\"app flex-row\">\n    <div class=\"w-100\">\n      <h1>{{ $t(\"docsign.review.review\") }}</h1>\n      <hr class=\"mb-4\" />\n      <div class=\"row-content\">\n        <div class=\"all-recipients\">\n          <div class=\"title\">{{ $t(\"docsign.review.title\") }}</div>\n          <b-form-group>\n            <label for=\"company\" class=\"subtitle mt-4\">\n              {{ $t(\"docsign.review.subtitle\") }}\n              <span class=\"text-danger\">*</span>\n            </label>\n            <b-form-input \n              type=\"text\" \n              :placeholder=\"coffeeSign\"\n              name=\"subject\"\n              :value=\"subject\"\n              v-model=\"review_form.subject\"\n              @input=\"inputSubject\"\n            ></b-form-input>\n          </b-form-group>\n          <b-form-group>\n            <label for=\"vat\" class=\"subtitle\">{{ $t(\"docsign.review.email\") }}</label>\n            <b-form-textarea \n              type=\"text\" \n              :placeholder=\"message\" \n              class=\"email-msg\"\n              :value=\"input_message\"\n              v-model=\"review_form.message\"\n              @input=\"inputMessage\"\n            ></b-form-textarea>\n          </b-form-group>\n          <div class=\"subtitle\">{{ $t(\"docsign.review.expiration\") }}</div>\n          <div class=\"d-flex align-items-center mt-3\">\n            <span>{{ $t(\"docsign.review.request.expire\") }}</span>\n            <b-input class=\"ml-3\" value=\"120\" style=\"width: 75px\" v-model=\"review_form.expiration\"></b-input>\n          </div>\n          <div class=\"d-flex align-items-center mt-3\">\n            <span>\n              {{ $t(\"docsign.review.request.scheduled\") }}\n              <strong>{{$t('May 1, 2019')}}</strong> {{ $t(\"docsign.review.request.at\") }}\n              <strong>{{$t('6:59:59 AM')}}</strong>\n            </span>\n          </div>\n        </div>\n        <div class=\"col-right-pannel\">\n          <div class=\"content-card\">\n            <div class=\"title\">{{ $t(\"docsign.review.documents\") }}</div>\n            <div v-for=\"(doc, key) in getDocuments\" :key=\"key\">\n              <div class=\"mt-4\" v-if=\"key==0\">{{doc.document_name}}</div>\n              <div class=\"mt-3\" v-else>{{doc.document_name}}</div>\n            </div>\n          </div>\n          <div class=\"content-card\">\n            <div class=\"title\">{{ $t(\"docsign.review.recipients\") }}</div>\n            <div class=\"recipients\">\n              <div class=\"recipient-item\" v-for=\"(recipient, index) in getRecipients\" :key=\"index+1\">\n                <div class=\"recipient-number\">{{index + 1}}</div>\n                <div class=\"info\">\n                  <div class=\"w-100 d-flex justify-content-between flex-wrap\">\n                    <span class=\"subtitle\">{{recipient.name}}</span>\n                    <span class=\"ml-auto\" v-if=\"recipient.action === 'sign'\">\n                      <i class=\"fa fa-pencil mr-2 comments\"></i>\n                      <span>{{$t('Needs to Sign')}}</span>\n                    </span>\n                    <span class=\"ml-auto\" v-else-if=\"recipient.action === 'copy'\">\n                      <UserIcon icon=\"CC.svg\" class=\"mr-2\"></UserIcon>\n                      <span>{{$t('Receives a copy')}}</span>\n                    </span>\n                    <span class=\"ml-auto\" v-else>\n                      <UserIcon icon=\"In personal signer.svg\" class=\"mr-2\"></UserIcon>\n                      <span>{{$t('In personal signer')}}</span>\n                    </span>\n                  </div>\n                  <div class=\"comments\" v-if=\"recipient.email\">{{recipient.email}}</div>\n                  <div class=\"comments\" v-else>Sharing via Kakao talk</div>\n                </div>\n              </div>\n            </div>\n            <div\n              class=\"comments mt-4\"\n            >{{ $t(\"docsign.review.recipients\") }}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"d-flex justify-content-end flex-wrap pt-4\">\n        <button class=\"btn btn-outline-primary min-width-124px m-1\" v-on:click=\"moveBackPage\">{{ $t(\"docsign.back\") }}</button>\n        <button class=\"btn btn-primary min-width-124px m-1\" v-on:click=\"moveNextPage\" style=\"position: relative\">\n        <i v-if=\"nextLoading\" class=\"fa fa-spinner fa-spin fa-3x\" style=\"position: absolute; top: 0; left: 33%;\" />\n        {{ $t(\"docsign.send\") }}</button>\n      </div>\n    </div>\n    <b-modal id=\"send-modal\" ref=\"send-modal\" hide-footer centered @hidden=\"onHidden\">\n      <div class=\"send-modal\">\n        <img src=\"img/icons/send.svg\" class=\"mb-4\" />\n        <div class=\"you-done\">{{ $t(\"docsign.review.modal.title\") }}</div>\n        <div\n          class=\"comments text-center\"\n          style=\"margin-bottom:30px\"\n        >{{ $t(\"docsign.review.modal.comments\") }}</div>\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary\"\n          v-on:click=\"$router.push('/payment/document-list');\"\n        >{{ $t(\"docsign.review.modal.button\") }}</button>\n      </div>\n    </b-modal>\n\n    <b-modal id=\"kakao-modal\" ref=\"kakao-modal\" hide-footer centered @hidden=\"onHiddenKakao\">\n      <div class=\"send-modal\">\n        <img src=\"img/icons/send.svg\" class=\"mb-4\" />\n        <div\n          class=\"comments text-center\"\n          style=\"margin-bottom:30px\"\n        >This account access time is already expired. Please, click button LOGIN VIA KAKAO to continue</div>\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary\"\n          v-on:click=\"loginWithKakao\"\n        > LOGIN VIA KAKAO </button>\n      </div>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport UserIcon from \"../../components/UserIcon\";\nimport { signTypes } from \"../../helpers/defaultValue\";\nimport config from \"../../config/config\";\nimport { mapGetters, mapState } from 'vuex'\nimport store from '../../store/store'\nimport { GET_DOCS, REVIEW_SEND_REQUEST } from '../../store/actions.type'\n\nexport default {\n  name: \"Review\",\n  components: {\n    UserIcon\n  },\n  data() {\n    return {\n      review_form:\n      {\n        subject: '',\n        message: '',\n        expiration: 120,\n        recipients: [],\n        name: ''\n      },\n      titleEmail:'',\n      nextLoading: false,\n      subjectData: '',\n      messageData: '',\n      isCheckAccessToken: false,\n    };\n  },\n  created()\n  {\n    store.dispatch(GET_DOCS, this.$route.query.document_id)\n    .then( res => {\n      this.review_form.name = this.converDocuments().join(', ')\n      this.review_form.recipients = this.getRecipients;\n      this.review_form.subject = 'Sign Request for '+this.review_form.name+' from Coffeesign.io'\n    })\n    .catch( err => {\n\n    });\n  },\n  mounted()\n  {\n    const scriptId = \"kakao_login\";\n    const isExist = !!document.getElementById(scriptId)\n    if (!isExist) {\n      const script = document.createElement(\"script\");\n      script.src = `https://developers.kakao.com/sdk/js/kakao.min.js`;\n      script.onload = () => this.initiate(this);\n      // script.onerror = error => this.handleError(error)\n      script.id = scriptId;\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\n    }\n  },\n  computed: {\n    ...mapGetters({\n        getRecipients: 'getRecipients',\n        getDocuments: 'getDocuments'\n      }),\n    subject() {\n      this.review_form.subject = this.$t('docsign.review.input_email_sub_1')+' '+this.review_form.name+' '+this.$t('docsign.review.input_email_sub_2');\n      return this.review_form.subject;\n    },\n    input_message() {\n      this.review_form.message = `${this.$t('docsign.review.input_message_1')}\n\n${this.$t('docsign.review.input_message_2')}`\n      \n      return this.review_form.message;\n    },\n    coffeeSign() {\n      return this.$t('docsign.review.placeholder.coffeeSign');\n    },\n    message() {\n      return this.$t('docsign.review.placeholder.message');\n    }\n  },\n  methods: {\n    initiate: comp => {\n      Kakao.init(config.KAKAO.javascriptKey);\n    },\n    loginWithKakao() {\n      let _self = this;\n      Kakao.Auth.login({\n        scope: \"talk_message,friends\",\n        success: function(resLogin) {\n          _self.moveNextPage()\n        },\n        fail: function(res) {\n          Kakao.Auth.logout() \n          if(res && res.msg) {\n            _self.$awn.alert(res.msg, {\n              position: \"bottom-left\",\n              labels: {\n                alert: \"Danger Message\"\n              }\n            });\n          }\n        }\n      });\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    checkAccessToken(){\n      let _self = this;\n      _self.isCheckAccessToken = false\n      Kakao.API.request({\n        url: \"/v1/api/talk/friends\",\n        success: function(res) {\n          _self.isCheckAccessToken = true\n        },\n        fail: function(res) {\n          console.log('res____', res)\n          Kakao.Auth.logout() \n          // if(res && res.msg) {\n          //   _self.$awn.alert(res.msg, {\n          //     position: \"bottom-left\",\n          //     labels: {\n          //       alert: \"Danger Message\"\n          //     }\n          //   });\n          // }\n          _self.$refs[\"kakao-modal\"].show();\n        }\n      });\n    },\n    inputSubject(e) {\n      this.subjectData = e;\n    },\n    inputMessage(e) {\n      this.messageData = e;\n    },\n    moveNextPage() {\n      let _self = this;\n      let accessToken = '';\n      let review_form = {\n        ...this.review_form, \n        subject:this.subjectData.length > 0 ? this.subjectData : this.review_form.subject, \n        document_id: this.$route.query.document_id,\n        message: this.messageData.length > 0 ? this.messageData : this.review_form.message, \n        access_token: accessToken.length > 0 ? accessToken : null,\n      }\n      this.nextLoading = true\n      store.dispatch( REVIEW_SEND_REQUEST , review_form)\n      .then( res => {\n        this.$refs[\"send-modal\"].show();\n        this.nextLoading = false\n      })\n      .catch( err => {\n        console.log('err', err)\n      }) \n    },\n    async moveNextPage1() {\n      let _self = this;\n      let accessToken = Kakao.Auth.getAccessToken()\n      if(accessToken) {\n        await _self.checkAccessToken()\n        let review_form = {\n          ...this.review_form, \n          subject:this.subjectData.length > 0 ? this.subjectData : this.review_form.subject, \n          document_id: this.$route.query.document_id,\n          message: this.messageData.length > 0 ? this.messageData : this.review_form.message, \n          access_token: accessToken.length > 0 ? accessToken : null, \n        }\n        this.nextLoading = true\n        store.dispatch( REVIEW_SEND_REQUEST , review_form)\n        .then( res => {\n          this.$refs[\"send-modal\"].show();\n          this.nextLoading = false\n        })\n        .catch( err => {\n          console.log('err', err)\n        })\n      } else {\n        _self.$refs[\"kakao-modal\"].show();\n      } \n    },\n    onHidden(){\n      this.$router.push(\"/payment/document-list\");\n    },\n    onHiddenKakao(){\n      let _self = this\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    moveBackPage() {\n      this.$router.push(\"/docu-sign/prepare?document_id=\"+this.$route.query.document_id);\n    },\n    converDocuments()\n    {\n      var data = this.getDocuments.map((animal) => {\n        return animal.document_name\n      })\n      return data;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import \"./Review.scss\";\n</style>\n\n"]}]}