{"remainingRequest":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/Jobs/DOAN-TT/client/src/components/connect/GoogleDrive.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/Jobs/DOAN-TT/client/src/components/connect/GoogleDrive.vue","mtime":1573548262161},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js","mtime":1571304325577},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js","mtime":1571304326381}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\n\nexport default {\n  name: \"GoogleDrive\",\n  components: {\n    UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data() {\n    return {\n      ...config.GOOGLE_CONFIG,\n      pickerApiLoaded: false,\n      oauthToken: null\n    };\n  },\n  methods: {\n    async chooserFile() {\n      // console.log(\"Clicked\");\n      await gapi.load(\"auth2\", () => {\n        // console.log(\"Auth2 Loaded\");\n        gapi.auth2.authorize(\n          {\n            client_id: this.clientId,\n            scope: this.scope,\n            immediate: false\n          },\n          this.handleAuthResult\n        );\n      });\n      gapi.load(\"picker\", () => {\n        // console.log(\"Picker Loaded\");\n        this.pickerApiLoaded = true;\n        this.createPicker();\n      });\n    },\n    handleAuthResult(authResult) {\n      // console.log(\"Handle Auth result\", authResult);\n      if (authResult && !authResult.error) {\n        this.oauthToken = authResult.access_token;\n        this.createPicker();\n      }\n    },\n    createPicker() {\n      // console.log(\"Create Picker\", google.picker);\n      if (this.pickerApiLoaded && this.oauthToken) {\n        var picker = new google.picker.PickerBuilder()\n          .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\n          .addView(google.picker.ViewId.DOCS)\n          .setOAuthToken(this.oauthToken)\n          .setDeveloperKey(this.developerKey)\n          .setCallback(this.pickerCallback)\n          .build();\n        picker.setVisible(true);\n      }\n    },\n    async pickerCallback(data) {\n      // console.log(\"PickerCallback\", data);\n      var url = \"nothing\";\n      var name = \"nothing\";\n      if (data[google.picker.Response.ACTION] === google.picker.Action.PICKED) {\n        // Array of Picked Files\n        if (data.docs && data.docs.length > 0) {\n          let attachments =\n            data.docs &&\n            data.docs.length > 0 &&\n            data.docs.map(v => {\n              // return convertUrlToFile(v, 'embedUrl');\n              return {\n                ...v,\n                type: extensionToMimeType(`${v.name.split(\".\")[1]}`),\n                size: v.sizeBytes,\n                downloadUrl: `https://drive.google.com/uc?id=${v.id}&export=download`,\n              };\n            });\n          this.$emit(\"addFiles\", attachments, true);\n        }\n      }\n    }\n  },\n  mounted() {\n    let gDrive = document.createElement(\"script\");\n    gDrive.setAttribute(\"type\", \"text/javascript\");\n    gDrive.setAttribute(\"src\", \"https://apis.google.com/js/api.js\");\n    document.head.appendChild(gDrive);\n  }\n};\n",{"version":3,"sources":["GoogleDrive.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GoogleDrive.vue","sourceRoot":"src/components/connect","sourcesContent":["<template>\n  <span v-on:click=\"chooserFile()\">\n    <UserIcon icon=\"google-drive.svg\" class=\"store-src-item\" />\n  </span>\n</template>\n\n<script>\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\n\nexport default {\n  name: \"GoogleDrive\",\n  components: {\n    UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data() {\n    return {\n      ...config.GOOGLE_CONFIG,\n      pickerApiLoaded: false,\n      oauthToken: null\n    };\n  },\n  methods: {\n    async chooserFile() {\n      // console.log(\"Clicked\");\n      await gapi.load(\"auth2\", () => {\n        // console.log(\"Auth2 Loaded\");\n        gapi.auth2.authorize(\n          {\n            client_id: this.clientId,\n            scope: this.scope,\n            immediate: false\n          },\n          this.handleAuthResult\n        );\n      });\n      gapi.load(\"picker\", () => {\n        // console.log(\"Picker Loaded\");\n        this.pickerApiLoaded = true;\n        this.createPicker();\n      });\n    },\n    handleAuthResult(authResult) {\n      // console.log(\"Handle Auth result\", authResult);\n      if (authResult && !authResult.error) {\n        this.oauthToken = authResult.access_token;\n        this.createPicker();\n      }\n    },\n    createPicker() {\n      // console.log(\"Create Picker\", google.picker);\n      if (this.pickerApiLoaded && this.oauthToken) {\n        var picker = new google.picker.PickerBuilder()\n          .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\n          .addView(google.picker.ViewId.DOCS)\n          .setOAuthToken(this.oauthToken)\n          .setDeveloperKey(this.developerKey)\n          .setCallback(this.pickerCallback)\n          .build();\n        picker.setVisible(true);\n      }\n    },\n    async pickerCallback(data) {\n      // console.log(\"PickerCallback\", data);\n      var url = \"nothing\";\n      var name = \"nothing\";\n      if (data[google.picker.Response.ACTION] === google.picker.Action.PICKED) {\n        // Array of Picked Files\n        if (data.docs && data.docs.length > 0) {\n          let attachments =\n            data.docs &&\n            data.docs.length > 0 &&\n            data.docs.map(v => {\n              // return convertUrlToFile(v, 'embedUrl');\n              return {\n                ...v,\n                type: extensionToMimeType(`${v.name.split(\".\")[1]}`),\n                size: v.sizeBytes,\n                downloadUrl: `https://drive.google.com/uc?id=${v.id}&export=download`,\n              };\n            });\n          this.$emit(\"addFiles\", attachments, true);\n        }\n      }\n    }\n  },\n  mounted() {\n    let gDrive = document.createElement(\"script\");\n    gDrive.setAttribute(\"type\", \"text/javascript\");\n    gDrive.setAttribute(\"src\", \"https://apis.google.com/js/api.js\");\n    document.head.appendChild(gDrive);\n  }\n};\n</script>\n"]}]}