{"remainingRequest":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/Jobs/DOAN-TT/client/src/components/connect/OneDrive.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/Jobs/DOAN-TT/client/src/components/connect/OneDrive.vue","mtime":1573548262162},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js","mtime":1571304325577},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js","mtime":1571304326381}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\n\nexport default {\n  name: \"OneDrive\",\n  components: {\n    UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data() {\n    return {\n      pickerApiLoaded: false,\n      oauthToken: null\n    };\n  },\n  methods: {\n    chooserFile() {\n      let self = this;\n      let odOptions = {\n        clientId: config.MICROSOFT.CLIENT_ID,\n        action: \"download\",\n        multiSelect: true,\n        openInNewWindow: true,\n        viewType: \"files\",\n        advanced: {\n          /** URL CHANGED */\n          // endpointHint: config.MICROSOFT.endpointHint\n          redirectUri: config.MICROSOFT.redirectUri,\n          // queryParameters: \"select=id,name,size,file,folder,photo,@microsoft.graph.downloadUrl\",\n        },\n        success: function(files) {\n          /* success handler */\n          let attachments =\n            files &&\n            files.value &&\n            files.value.length > 0 &&\n            files.value.map(v => {\n              // return convertUrlToFile(v, '@microsoft.graph.downloadUrl');\n              return {\n                ...v,\n                type: extensionToMimeType(`${v.name.split(\".\")[1]}`),\n                downloadUrl: v[\"@microsoft.graph.downloadUrl\"],\n              };\n            });\n          self.$emit(\"addFiles\", attachments, true);\n        },\n        cancel: function() {\n          /* cancel handler */\n          console.log(\"cancel\");\n        },\n        error: function(error) {\n          /* error handler */\n          console.log(\"error\", error);\n        }\n      };\n      OneDrive.open(odOptions);\n    }\n  },\n  mounted() {\n    let oneDrive = document.createElement(\"script\");\n    oneDrive.setAttribute(\"type\", \"text/javascript\");\n    oneDrive.setAttribute(\"src\", \"https://js.live.net/v7.2/OneDrive.js\");\n    // oneDrive.setAttribute(\"id\", \"onedrive-js\");\n    // oneDrive.setAttribute(\"client-id\", config.MICROSOFT.CLIENT_ID);\n    document.head.appendChild(oneDrive);\n  }\n};\n",{"version":3,"sources":["OneDrive.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"OneDrive.vue","sourceRoot":"src/components/connect","sourcesContent":["<template>\n  <span v-on:click=\"chooserFile()\">\n    <UserIcon icon=\"onedrive.svg\" class=\"store-src-item\" />\n  </span>\n</template>\n\n<script>\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\n\nexport default {\n  name: \"OneDrive\",\n  components: {\n    UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data() {\n    return {\n      pickerApiLoaded: false,\n      oauthToken: null\n    };\n  },\n  methods: {\n    chooserFile() {\n      let self = this;\n      let odOptions = {\n        clientId: config.MICROSOFT.CLIENT_ID,\n        action: \"download\",\n        multiSelect: true,\n        openInNewWindow: true,\n        viewType: \"files\",\n        advanced: {\n          /** URL CHANGED */\n          // endpointHint: config.MICROSOFT.endpointHint\n          redirectUri: config.MICROSOFT.redirectUri,\n          // queryParameters: \"select=id,name,size,file,folder,photo,@microsoft.graph.downloadUrl\",\n        },\n        success: function(files) {\n          /* success handler */\n          let attachments =\n            files &&\n            files.value &&\n            files.value.length > 0 &&\n            files.value.map(v => {\n              // return convertUrlToFile(v, '@microsoft.graph.downloadUrl');\n              return {\n                ...v,\n                type: extensionToMimeType(`${v.name.split(\".\")[1]}`),\n                downloadUrl: v[\"@microsoft.graph.downloadUrl\"],\n              };\n            });\n          self.$emit(\"addFiles\", attachments, true);\n        },\n        cancel: function() {\n          /* cancel handler */\n          console.log(\"cancel\");\n        },\n        error: function(error) {\n          /* error handler */\n          console.log(\"error\", error);\n        }\n      };\n      OneDrive.open(odOptions);\n    }\n  },\n  mounted() {\n    let oneDrive = document.createElement(\"script\");\n    oneDrive.setAttribute(\"type\", \"text/javascript\");\n    oneDrive.setAttribute(\"src\", \"https://js.live.net/v7.2/OneDrive.js\");\n    // oneDrive.setAttribute(\"id\", \"onedrive-js\");\n    // oneDrive.setAttribute(\"client-id\", config.MICROSOFT.CLIENT_ID);\n    document.head.appendChild(oneDrive);\n  }\n};\n</script>\n"]}]}