{"remainingRequest":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js!/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/Jobs/DOAN-TT/client/src/views/document/Review.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/Jobs/DOAN-TT/client/src/views/document/Review.vue","mtime":1573548269939},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js","mtime":1571304325577},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js","mtime":1571304326381}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/var/www/html/Jobs/DOAN-TT/client/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/var/www/html/Jobs/DOAN-TT/client/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UserIcon from \"../../components/UserIcon\";\nimport { signTypes } from \"../../helpers/defaultValue\";\nimport config from \"../../config/config\";\nimport { mapGetters, mapState } from 'vuex';\nimport store from \"../../store/store\";\nimport { GET_DOCS, REVIEW_SEND_REQUEST } from \"../../store/actions.type\";\nexport default {\n  name: \"Review\",\n  components: {\n    UserIcon: UserIcon\n  },\n  data: function data() {\n    return {\n      review_form: {\n        subject: '',\n        message: '',\n        expiration: 120,\n        recipients: [],\n        name: ''\n      },\n      titleEmail: '',\n      nextLoading: false,\n      subjectData: '',\n      messageData: '',\n      isCheckAccessToken: false\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    store.dispatch(GET_DOCS, this.$route.query.document_id).then(function (res) {\n      _this.review_form.name = _this.converDocuments().join(', ');\n      _this.review_form.recipients = _this.getRecipients;\n      _this.review_form.subject = 'Sign Request for ' + _this.review_form.name + ' from Coffeesign.io';\n    }).catch(function (err) {});\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    var scriptId = \"kakao_login\";\n    var isExist = !!document.getElementById(scriptId);\n\n    if (!isExist) {\n      var script = document.createElement(\"script\");\n      script.src = \"https://developers.kakao.com/sdk/js/kakao.min.js\";\n\n      script.onload = function () {\n        return _this2.initiate(_this2);\n      }; // script.onerror = error => this.handleError(error)\n\n\n      script.id = scriptId;\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\n    }\n  },\n  computed: _objectSpread({}, mapGetters({\n    getRecipients: 'getRecipients',\n    getDocuments: 'getDocuments'\n  }), {\n    subject: function subject() {\n      this.review_form.subject = this.$t('docsign.review.input_email_sub_1') + ' ' + this.review_form.name + ' ' + this.$t('docsign.review.input_email_sub_2');\n      return this.review_form.subject;\n    },\n    input_message: function input_message() {\n      this.review_form.message = \"\".concat(this.$t('docsign.review.input_message_1'), \"\\n\\n\").concat(this.$t('docsign.review.input_message_2'));\n      return this.review_form.message;\n    },\n    coffeeSign: function coffeeSign() {\n      return this.$t('docsign.review.placeholder.coffeeSign');\n    },\n    message: function message() {\n      return this.$t('docsign.review.placeholder.message');\n    }\n  }),\n  methods: {\n    initiate: function initiate(comp) {\n      Kakao.init(config.KAKAO.javascriptKey);\n    },\n    loginWithKakao: function loginWithKakao() {\n      var _self = this;\n\n      Kakao.Auth.login({\n        scope: \"talk_message,friends\",\n        success: function success(resLogin) {\n          _self.moveNextPage();\n        },\n        fail: function fail(res) {\n          Kakao.Auth.logout();\n\n          if (res && res.msg) {\n            _self.$awn.alert(res.msg, {\n              position: \"bottom-left\",\n              labels: {\n                alert: \"Danger Message\"\n              }\n            });\n          }\n        }\n      });\n\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    checkAccessToken: function checkAccessToken() {\n      var _self = this;\n\n      _self.isCheckAccessToken = false;\n      Kakao.API.request({\n        url: \"/v1/api/talk/friends\",\n        success: function success(res) {\n          _self.isCheckAccessToken = true;\n        },\n        fail: function fail(res) {\n          console.log('res____', res);\n          Kakao.Auth.logout(); // if(res && res.msg) {\n          //   _self.$awn.alert(res.msg, {\n          //     position: \"bottom-left\",\n          //     labels: {\n          //       alert: \"Danger Message\"\n          //     }\n          //   });\n          // }\n\n          _self.$refs[\"kakao-modal\"].show();\n        }\n      });\n    },\n    inputSubject: function inputSubject(e) {\n      this.subjectData = e;\n    },\n    inputMessage: function inputMessage(e) {\n      this.messageData = e;\n    },\n    moveNextPage: function moveNextPage() {\n      var _this3 = this;\n\n      var _self = this;\n\n      var accessToken = '';\n\n      var review_form = _objectSpread({}, this.review_form, {\n        subject: this.subjectData.length > 0 ? this.subjectData : this.review_form.subject,\n        document_id: this.$route.query.document_id,\n        message: this.messageData.length > 0 ? this.messageData : this.review_form.message,\n        access_token: accessToken.length > 0 ? accessToken : null\n      });\n\n      this.nextLoading = true;\n      store.dispatch(REVIEW_SEND_REQUEST, review_form).then(function (res) {\n        _this3.$refs[\"send-modal\"].show();\n\n        _this3.nextLoading = false;\n      }).catch(function (err) {\n        console.log('err', err);\n      });\n    },\n    moveNextPage1: function () {\n      var _moveNextPage = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        var _self, accessToken, review_form;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _self = this;\n                accessToken = Kakao.Auth.getAccessToken();\n\n                if (!accessToken) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 5;\n                return _self.checkAccessToken();\n\n              case 5:\n                review_form = _objectSpread({}, this.review_form, {\n                  subject: this.subjectData.length > 0 ? this.subjectData : this.review_form.subject,\n                  document_id: this.$route.query.document_id,\n                  message: this.messageData.length > 0 ? this.messageData : this.review_form.message,\n                  access_token: accessToken.length > 0 ? accessToken : null\n                });\n                this.nextLoading = true;\n                store.dispatch(REVIEW_SEND_REQUEST, review_form).then(function (res) {\n                  _this4.$refs[\"send-modal\"].show();\n\n                  _this4.nextLoading = false;\n                }).catch(function (err) {\n                  console.log('err', err);\n                });\n                _context.next = 11;\n                break;\n\n              case 10:\n                _self.$refs[\"kakao-modal\"].show();\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function moveNextPage1() {\n        return _moveNextPage.apply(this, arguments);\n      }\n\n      return moveNextPage1;\n    }(),\n    onHidden: function onHidden() {\n      this.$router.push(\"/payment/document-list\");\n    },\n    onHiddenKakao: function onHiddenKakao() {\n      var _self = this;\n\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    moveBackPage: function moveBackPage() {\n      this.$router.push(\"/docu-sign/prepare?document_id=\" + this.$route.query.document_id);\n    },\n    converDocuments: function converDocuments() {\n      var data = this.getDocuments.map(function (animal) {\n        return animal.document_name;\n      });\n      return data;\n    }\n  }\n};",{"version":3,"sources":["Review.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"app flex-row\">\n    <div class=\"w-100\">\n      <h1>{{ $t(\"docsign.review.review\") }}</h1>\n      <hr class=\"mb-4\" />\n      <div class=\"row-content\">\n        <div class=\"all-recipients\">\n          <div class=\"title\">{{ $t(\"docsign.review.title\") }}</div>\n          <b-form-group>\n            <label for=\"company\" class=\"subtitle mt-4\">\n              {{ $t(\"docsign.review.subtitle\") }}\n              <span class=\"text-danger\">*</span>\n            </label>\n            <b-form-input \n              type=\"text\" \n              :placeholder=\"coffeeSign\"\n              name=\"subject\"\n              :value=\"subject\"\n              v-model=\"review_form.subject\"\n              @input=\"inputSubject\"\n            ></b-form-input>\n          </b-form-group>\n          <b-form-group>\n            <label for=\"vat\" class=\"subtitle\">{{ $t(\"docsign.review.email\") }}</label>\n            <b-form-textarea \n              type=\"text\" \n              :placeholder=\"message\" \n              class=\"email-msg\"\n              :value=\"input_message\"\n              v-model=\"review_form.message\"\n              @input=\"inputMessage\"\n            ></b-form-textarea>\n          </b-form-group>\n          <div class=\"subtitle\">{{ $t(\"docsign.review.expiration\") }}</div>\n          <div class=\"d-flex align-items-center mt-3\">\n            <span>{{ $t(\"docsign.review.request.expire\") }}</span>\n            <b-input class=\"ml-3\" value=\"120\" style=\"width: 75px\" v-model=\"review_form.expiration\"></b-input>\n          </div>\n          <div class=\"d-flex align-items-center mt-3\">\n            <span>\n              {{ $t(\"docsign.review.request.scheduled\") }}\n              <strong>{{$t('May 1, 2019')}}</strong> {{ $t(\"docsign.review.request.at\") }}\n              <strong>{{$t('6:59:59 AM')}}</strong>\n            </span>\n          </div>\n        </div>\n        <div class=\"col-right-pannel\">\n          <div class=\"content-card\">\n            <div class=\"title\">{{ $t(\"docsign.review.documents\") }}</div>\n            <div v-for=\"(doc, key) in getDocuments\" :key=\"key\">\n              <div class=\"mt-4\" v-if=\"key==0\">{{doc.document_name}}</div>\n              <div class=\"mt-3\" v-else>{{doc.document_name}}</div>\n            </div>\n          </div>\n          <div class=\"content-card\">\n            <div class=\"title\">{{ $t(\"docsign.review.recipients\") }}</div>\n            <div class=\"recipients\">\n              <div class=\"recipient-item\" v-for=\"(recipient, index) in getRecipients\" :key=\"index+1\">\n                <div class=\"recipient-number\">{{index + 1}}</div>\n                <div class=\"info\">\n                  <div class=\"w-100 d-flex justify-content-between flex-wrap\">\n                    <span class=\"subtitle\">{{recipient.name}}</span>\n                    <span class=\"ml-auto\" v-if=\"recipient.action === 'sign'\">\n                      <i class=\"fa fa-pencil mr-2 comments\"></i>\n                      <span>{{$t('Needs to Sign')}}</span>\n                    </span>\n                    <span class=\"ml-auto\" v-else-if=\"recipient.action === 'copy'\">\n                      <UserIcon icon=\"CC.svg\" class=\"mr-2\"></UserIcon>\n                      <span>{{$t('Receives a copy')}}</span>\n                    </span>\n                    <span class=\"ml-auto\" v-else>\n                      <UserIcon icon=\"In personal signer.svg\" class=\"mr-2\"></UserIcon>\n                      <span>{{$t('In personal signer')}}</span>\n                    </span>\n                  </div>\n                  <div class=\"comments\" v-if=\"recipient.email\">{{recipient.email}}</div>\n                  <div class=\"comments\" v-else>Sharing via Kakao talk</div>\n                </div>\n              </div>\n            </div>\n            <div\n              class=\"comments mt-4\"\n            >{{ $t(\"docsign.review.recipients\") }}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"d-flex justify-content-end flex-wrap pt-4\">\n        <button class=\"btn btn-outline-primary min-width-124px m-1\" v-on:click=\"moveBackPage\">{{ $t(\"docsign.back\") }}</button>\n        <button class=\"btn btn-primary min-width-124px m-1\" v-on:click=\"moveNextPage\" style=\"position: relative\">\n        <i v-if=\"nextLoading\" class=\"fa fa-spinner fa-spin fa-3x\" style=\"position: absolute; top: 0; left: 33%;\" />\n        {{ $t(\"docsign.send\") }}</button>\n      </div>\n    </div>\n    <b-modal id=\"send-modal\" ref=\"send-modal\" hide-footer centered @hidden=\"onHidden\">\n      <div class=\"send-modal\">\n        <img src=\"img/icons/send.svg\" class=\"mb-4\" />\n        <div class=\"you-done\">{{ $t(\"docsign.review.modal.title\") }}</div>\n        <div\n          class=\"comments text-center\"\n          style=\"margin-bottom:30px\"\n        >{{ $t(\"docsign.review.modal.comments\") }}</div>\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary\"\n          v-on:click=\"$router.push('/payment/document-list');\"\n        >{{ $t(\"docsign.review.modal.button\") }}</button>\n      </div>\n    </b-modal>\n\n    <b-modal id=\"kakao-modal\" ref=\"kakao-modal\" hide-footer centered @hidden=\"onHiddenKakao\">\n      <div class=\"send-modal\">\n        <img src=\"img/icons/send.svg\" class=\"mb-4\" />\n        <div\n          class=\"comments text-center\"\n          style=\"margin-bottom:30px\"\n        >This account access time is already expired. Please, click button LOGIN VIA KAKAO to continue</div>\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary\"\n          v-on:click=\"loginWithKakao\"\n        > LOGIN VIA KAKAO </button>\n      </div>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport UserIcon from \"../../components/UserIcon\";\nimport { signTypes } from \"../../helpers/defaultValue\";\nimport config from \"../../config/config\";\nimport { mapGetters, mapState } from 'vuex'\nimport store from '../../store/store'\nimport { GET_DOCS, REVIEW_SEND_REQUEST } from '../../store/actions.type'\n\nexport default {\n  name: \"Review\",\n  components: {\n    UserIcon\n  },\n  data() {\n    return {\n      review_form:\n      {\n        subject: '',\n        message: '',\n        expiration: 120,\n        recipients: [],\n        name: ''\n      },\n      titleEmail:'',\n      nextLoading: false,\n      subjectData: '',\n      messageData: '',\n      isCheckAccessToken: false,\n    };\n  },\n  created()\n  {\n    store.dispatch(GET_DOCS, this.$route.query.document_id)\n    .then( res => {\n      this.review_form.name = this.converDocuments().join(', ')\n      this.review_form.recipients = this.getRecipients;\n      this.review_form.subject = 'Sign Request for '+this.review_form.name+' from Coffeesign.io'\n    })\n    .catch( err => {\n\n    });\n  },\n  mounted()\n  {\n    const scriptId = \"kakao_login\";\n    const isExist = !!document.getElementById(scriptId)\n    if (!isExist) {\n      const script = document.createElement(\"script\");\n      script.src = `https://developers.kakao.com/sdk/js/kakao.min.js`;\n      script.onload = () => this.initiate(this);\n      // script.onerror = error => this.handleError(error)\n      script.id = scriptId;\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\n    }\n  },\n  computed: {\n    ...mapGetters({\n        getRecipients: 'getRecipients',\n        getDocuments: 'getDocuments'\n      }),\n    subject() {\n      this.review_form.subject = this.$t('docsign.review.input_email_sub_1')+' '+this.review_form.name+' '+this.$t('docsign.review.input_email_sub_2');\n      return this.review_form.subject;\n    },\n    input_message() {\n      this.review_form.message = `${this.$t('docsign.review.input_message_1')}\n\n${this.$t('docsign.review.input_message_2')}`\n      \n      return this.review_form.message;\n    },\n    coffeeSign() {\n      return this.$t('docsign.review.placeholder.coffeeSign');\n    },\n    message() {\n      return this.$t('docsign.review.placeholder.message');\n    }\n  },\n  methods: {\n    initiate: comp => {\n      Kakao.init(config.KAKAO.javascriptKey);\n    },\n    loginWithKakao() {\n      let _self = this;\n      Kakao.Auth.login({\n        scope: \"talk_message,friends\",\n        success: function(resLogin) {\n          _self.moveNextPage()\n        },\n        fail: function(res) {\n          Kakao.Auth.logout() \n          if(res && res.msg) {\n            _self.$awn.alert(res.msg, {\n              position: \"bottom-left\",\n              labels: {\n                alert: \"Danger Message\"\n              }\n            });\n          }\n        }\n      });\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    checkAccessToken(){\n      let _self = this;\n      _self.isCheckAccessToken = false\n      Kakao.API.request({\n        url: \"/v1/api/talk/friends\",\n        success: function(res) {\n          _self.isCheckAccessToken = true\n        },\n        fail: function(res) {\n          console.log('res____', res)\n          Kakao.Auth.logout() \n          // if(res && res.msg) {\n          //   _self.$awn.alert(res.msg, {\n          //     position: \"bottom-left\",\n          //     labels: {\n          //       alert: \"Danger Message\"\n          //     }\n          //   });\n          // }\n          _self.$refs[\"kakao-modal\"].show();\n        }\n      });\n    },\n    inputSubject(e) {\n      this.subjectData = e;\n    },\n    inputMessage(e) {\n      this.messageData = e;\n    },\n    moveNextPage() {\n      let _self = this;\n      let accessToken = '';\n      let review_form = {\n        ...this.review_form, \n        subject:this.subjectData.length > 0 ? this.subjectData : this.review_form.subject, \n        document_id: this.$route.query.document_id,\n        message: this.messageData.length > 0 ? this.messageData : this.review_form.message, \n        access_token: accessToken.length > 0 ? accessToken : null,\n      }\n      this.nextLoading = true\n      store.dispatch( REVIEW_SEND_REQUEST , review_form)\n      .then( res => {\n        this.$refs[\"send-modal\"].show();\n        this.nextLoading = false\n      })\n      .catch( err => {\n        console.log('err', err)\n      }) \n    },\n    async moveNextPage1() {\n      let _self = this;\n      let accessToken = Kakao.Auth.getAccessToken()\n      if(accessToken) {\n        await _self.checkAccessToken()\n        let review_form = {\n          ...this.review_form, \n          subject:this.subjectData.length > 0 ? this.subjectData : this.review_form.subject, \n          document_id: this.$route.query.document_id,\n          message: this.messageData.length > 0 ? this.messageData : this.review_form.message, \n          access_token: accessToken.length > 0 ? accessToken : null, \n        }\n        this.nextLoading = true\n        store.dispatch( REVIEW_SEND_REQUEST , review_form)\n        .then( res => {\n          this.$refs[\"send-modal\"].show();\n          this.nextLoading = false\n        })\n        .catch( err => {\n          console.log('err', err)\n        })\n      } else {\n        _self.$refs[\"kakao-modal\"].show();\n      } \n    },\n    onHidden(){\n      this.$router.push(\"/payment/document-list\");\n    },\n    onHiddenKakao(){\n      let _self = this\n      _self.$refs[\"kakao-modal\"].hide();\n    },\n    moveBackPage() {\n      this.$router.push(\"/docu-sign/prepare?document_id=\"+this.$route.query.document_id);\n    },\n    converDocuments()\n    {\n      var data = this.getDocuments.map((animal) => {\n        return animal.document_name\n      })\n      return data;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import \"./Review.scss\";\n</style>\n\n"],"sourceRoot":"src/views/document"}]}