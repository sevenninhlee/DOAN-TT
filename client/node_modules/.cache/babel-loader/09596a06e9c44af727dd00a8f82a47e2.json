{"remainingRequest":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js!/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/html/Jobs/DOAN-TT/client/src/components/connect/GoogleDrive.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/html/Jobs/DOAN-TT/client/src/components/connect/GoogleDrive.vue","mtime":1573548262161},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/babel-loader/lib/index.js","mtime":1571304325577},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/cache-loader/dist/cjs.js","mtime":1571633391755},{"path":"/var/www/html/Jobs/DOAN-TT/client/node_modules/vue-loader/lib/index.js","mtime":1571304326381}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/var/www/html/Jobs/DOAN-TT/client/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/var/www/html/Jobs/DOAN-TT/client/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\nexport default {\n  name: \"GoogleDrive\",\n  components: {\n    UserIcon: UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data: function data() {\n    return _objectSpread({}, config.GOOGLE_CONFIG, {\n      pickerApiLoaded: false,\n      oauthToken: null\n    });\n  },\n  methods: {\n    chooserFile: function () {\n      var _chooserFile = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return gapi.load(\"auth2\", function () {\n                  // console.log(\"Auth2 Loaded\");\n                  gapi.auth2.authorize({\n                    client_id: _this.clientId,\n                    scope: _this.scope,\n                    immediate: false\n                  }, _this.handleAuthResult);\n                });\n\n              case 2:\n                gapi.load(\"picker\", function () {\n                  // console.log(\"Picker Loaded\");\n                  _this.pickerApiLoaded = true;\n\n                  _this.createPicker();\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function chooserFile() {\n        return _chooserFile.apply(this, arguments);\n      }\n\n      return chooserFile;\n    }(),\n    handleAuthResult: function handleAuthResult(authResult) {\n      // console.log(\"Handle Auth result\", authResult);\n      if (authResult && !authResult.error) {\n        this.oauthToken = authResult.access_token;\n        this.createPicker();\n      }\n    },\n    createPicker: function createPicker() {\n      // console.log(\"Create Picker\", google.picker);\n      if (this.pickerApiLoaded && this.oauthToken) {\n        var picker = new google.picker.PickerBuilder().enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(google.picker.ViewId.DOCS).setOAuthToken(this.oauthToken).setDeveloperKey(this.developerKey).setCallback(this.pickerCallback).build();\n        picker.setVisible(true);\n      }\n    },\n    pickerCallback: function () {\n      var _pickerCallback = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(data) {\n        var url, name, attachments;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // console.log(\"PickerCallback\", data);\n                url = \"nothing\";\n                name = \"nothing\";\n\n                if (data[google.picker.Response.ACTION] === google.picker.Action.PICKED) {\n                  // Array of Picked Files\n                  if (data.docs && data.docs.length > 0) {\n                    attachments = data.docs && data.docs.length > 0 && data.docs.map(function (v) {\n                      // return convertUrlToFile(v, 'embedUrl');\n                      return _objectSpread({}, v, {\n                        type: extensionToMimeType(\"\".concat(v.name.split(\".\")[1])),\n                        size: v.sizeBytes,\n                        downloadUrl: \"https://drive.google.com/uc?id=\".concat(v.id, \"&export=download\")\n                      });\n                    });\n                    this.$emit(\"addFiles\", attachments, true);\n                  }\n                }\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function pickerCallback(_x) {\n        return _pickerCallback.apply(this, arguments);\n      }\n\n      return pickerCallback;\n    }()\n  },\n  mounted: function mounted() {\n    var gDrive = document.createElement(\"script\");\n    gDrive.setAttribute(\"type\", \"text/javascript\");\n    gDrive.setAttribute(\"src\", \"https://apis.google.com/js/api.js\");\n    document.head.appendChild(gDrive);\n  }\n};",{"version":3,"sources":["GoogleDrive.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAOA,OAAA,QAAA;AACA,OAAA,MAAA;AACA,SAAA,mBAAA,EAAA,gBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,QAAA,EAAA;AADA,GAFA;AAKA,EAAA,KAAA,EAAA;AACA,IAAA,UAAA,EAAA;AADA,GALA;AAQA,EAAA,IARA,kBAQA;AACA,6BACA,MAAA,CAAA,aADA;AAEA,MAAA,eAAA,EAAA,KAFA;AAGA,MAAA,UAAA,EAAA;AAHA;AAKA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA,IAAA,WADA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGA,IAAA,CAAA,IAAA,CAAA,OAAA,EAAA,YAAA;AACA;AACA,kBAAA,IAAA,CAAA,KAAA,CAAA,SAAA,CACA;AACA,oBAAA,SAAA,EAAA,KAAA,CAAA,QADA;AAEA,oBAAA,KAAA,EAAA,KAAA,CAAA,KAFA;AAGA,oBAAA,SAAA,EAAA;AAHA,mBADA,EAMA,KAAA,CAAA,gBANA;AAQA,iBAVA,CAHA;;AAAA;AAcA,gBAAA,IAAA,CAAA,IAAA,CAAA,QAAA,EAAA,YAAA;AACA;AACA,kBAAA,KAAA,CAAA,eAAA,GAAA,IAAA;;AACA,kBAAA,KAAA,CAAA,YAAA;AACA,iBAJA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAoBA,IAAA,gBApBA,4BAoBA,UApBA,EAoBA;AACA;AACA,UAAA,UAAA,IAAA,CAAA,UAAA,CAAA,KAAA,EAAA;AACA,aAAA,UAAA,GAAA,UAAA,CAAA,YAAA;AACA,aAAA,YAAA;AACA;AACA,KA1BA;AA2BA,IAAA,YA3BA,0BA2BA;AACA;AACA,UAAA,KAAA,eAAA,IAAA,KAAA,UAAA,EAAA;AACA,YAAA,MAAA,GAAA,IAAA,MAAA,CAAA,MAAA,CAAA,aAAA,GACA,aADA,CACA,MAAA,CAAA,MAAA,CAAA,OAAA,CAAA,mBADA,EAEA,OAFA,CAEA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,IAFA,EAGA,aAHA,CAGA,KAAA,UAHA,EAIA,eAJA,CAIA,KAAA,YAJA,EAKA,WALA,CAKA,KAAA,cALA,EAMA,KANA,EAAA;AAOA,QAAA,MAAA,CAAA,UAAA,CAAA,IAAA;AACA;AACA,KAvCA;AAwCA,IAAA,cAxCA;AAAA;AAAA;AAAA,gDAwCA,IAxCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyCA;AACA,gBAAA,GA1CA,GA0CA,SA1CA;AA2CA,gBAAA,IA3CA,GA2CA,SA3CA;;AA4CA,oBAAA,IAAA,CAAA,MAAA,CAAA,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,KAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,EAAA;AACA;AACA,sBAAA,IAAA,CAAA,IAAA,IAAA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,oBAAA,WADA,GAEA,IAAA,CAAA,IAAA,IACA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CADA,IAEA,IAAA,CAAA,IAAA,CAAA,GAAA,CAAA,UAAA,CAAA,EAAA;AACA;AACA,+CACA,CADA;AAEA,wBAAA,IAAA,EAAA,mBAAA,WAAA,CAAA,CAAA,IAAA,CAAA,KAAA,CAAA,GAAA,EAAA,CAAA,CAAA,EAFA;AAGA,wBAAA,IAAA,EAAA,CAAA,CAAA,SAHA;AAIA,wBAAA,WAAA,2CAAA,CAAA,CAAA,EAAA;AAJA;AAMA,qBARA,CAJA;AAaA,yBAAA,KAAA,CAAA,UAAA,EAAA,WAAA,EAAA,IAAA;AACA;AACA;;AA7DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAfA;AA+EA,EAAA,OA/EA,qBA+EA;AACA,QAAA,MAAA,GAAA,QAAA,CAAA,aAAA,CAAA,QAAA,CAAA;AACA,IAAA,MAAA,CAAA,YAAA,CAAA,MAAA,EAAA,iBAAA;AACA,IAAA,MAAA,CAAA,YAAA,CAAA,KAAA,EAAA,mCAAA;AACA,IAAA,QAAA,CAAA,IAAA,CAAA,WAAA,CAAA,MAAA;AACA;AApFA,CAAA","sourcesContent":["<template>\n  <span v-on:click=\"chooserFile()\">\n    <UserIcon icon=\"google-drive.svg\" class=\"store-src-item\" />\n  </span>\n</template>\n\n<script>\nimport UserIcon from \"../UserIcon\";\nimport config from \"../../config/config\";\nimport { extensionToMimeType, convertUrlToFile } from \"../../helpers\";\n\nexport default {\n  name: \"GoogleDrive\",\n  components: {\n    UserIcon\n  },\n  props: {\n    prop_files: Object\n  },\n  data() {\n    return {\n      ...config.GOOGLE_CONFIG,\n      pickerApiLoaded: false,\n      oauthToken: null\n    };\n  },\n  methods: {\n    async chooserFile() {\n      // console.log(\"Clicked\");\n      await gapi.load(\"auth2\", () => {\n        // console.log(\"Auth2 Loaded\");\n        gapi.auth2.authorize(\n          {\n            client_id: this.clientId,\n            scope: this.scope,\n            immediate: false\n          },\n          this.handleAuthResult\n        );\n      });\n      gapi.load(\"picker\", () => {\n        // console.log(\"Picker Loaded\");\n        this.pickerApiLoaded = true;\n        this.createPicker();\n      });\n    },\n    handleAuthResult(authResult) {\n      // console.log(\"Handle Auth result\", authResult);\n      if (authResult && !authResult.error) {\n        this.oauthToken = authResult.access_token;\n        this.createPicker();\n      }\n    },\n    createPicker() {\n      // console.log(\"Create Picker\", google.picker);\n      if (this.pickerApiLoaded && this.oauthToken) {\n        var picker = new google.picker.PickerBuilder()\n          .enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\n          .addView(google.picker.ViewId.DOCS)\n          .setOAuthToken(this.oauthToken)\n          .setDeveloperKey(this.developerKey)\n          .setCallback(this.pickerCallback)\n          .build();\n        picker.setVisible(true);\n      }\n    },\n    async pickerCallback(data) {\n      // console.log(\"PickerCallback\", data);\n      var url = \"nothing\";\n      var name = \"nothing\";\n      if (data[google.picker.Response.ACTION] === google.picker.Action.PICKED) {\n        // Array of Picked Files\n        if (data.docs && data.docs.length > 0) {\n          let attachments =\n            data.docs &&\n            data.docs.length > 0 &&\n            data.docs.map(v => {\n              // return convertUrlToFile(v, 'embedUrl');\n              return {\n                ...v,\n                type: extensionToMimeType(`${v.name.split(\".\")[1]}`),\n                size: v.sizeBytes,\n                downloadUrl: `https://drive.google.com/uc?id=${v.id}&export=download`,\n              };\n            });\n          this.$emit(\"addFiles\", attachments, true);\n        }\n      }\n    }\n  },\n  mounted() {\n    let gDrive = document.createElement(\"script\");\n    gDrive.setAttribute(\"type\", \"text/javascript\");\n    gDrive.setAttribute(\"src\", \"https://apis.google.com/js/api.js\");\n    document.head.appendChild(gDrive);\n  }\n};\n</script>\n"],"sourceRoot":"src/components/connect"}]}